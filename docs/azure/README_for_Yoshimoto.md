# Azure実装開始にあたってのご案内（吉本様向け）

## はじめに
- 本プロジェクトは、既存のAWS実装を参照しつつ、Azureで新規に同等機能のアプリケーションを構築いただく取り組みです。
- 実装方針は自由ですが、添付の要件を満たすことを最優先としてください。
- 参考資料：`docs/azure/Azure議事録アプリ新規実装要件定義書.md`、`docs/azure/RFP.md`、および `docs/specs/` 配下の仕様書。

## 注意事項
- 毎日の作業内容を、別途取り決める方法（例: 日報チャンネル/Issue/Notion/github）で必ず記録してください。
- このリポジトリの内容はすべて参照可能ですが、顧客環境情報や秘匿情報を含む可能性があるため、取り扱いには十分ご注意ください。基本的に mainブランチを参照いただくことを推奨します。
- 既存アプリの実装に不備や最適でない箇所がある場合があります。Azure新規開発においては、要件を満たすことを前提に、適宜改善提案・改善実装を行ってください。
- 機能要件・非機能要件は下記に明記します。原則これらを満たすことが必須であり、それ以外の実装方針は自由にご判断ください。
- すべての処理は原則としてVPC内部（プライベートネットワーク）で完結させ、インターネット側に機密情報が露出しないよう細心の注意を払ってください。
- 質問や不明点があれば、いつでも Yuto_Hara へご連絡ください。

## 機能要件
- ファイルアップロード（音声/動画、複数フォーマット）
- 多言語文字起こし（日本語/英語）
- 話者認識と話者名編集（音声プレビュー含む）
- 箇条書き要約/議事録生成/タスク一覧生成（選択式）
- リアルタイム進捗表示（処理ステータス更新）
- 生成物の一括ダウンロードとバックエンド経由の安全なファイル削除
- 箇条書き・議事録・タスク一覧の生成は Azure 内に構築する Dify インスタンスで実施してください（同フォルダ内のワークフロー yml をそのまま利用可能）。

### 利用制限（クォータ）
- 残り使用時間（分）
  - 文字起こし完了時に、音声長（秒）を分に切り上げた値を組織ごとにアトミックに減算。
  - 不足時は処理を停止し、ユーザーへ不足メッセージを提示。
- タスク生成回数
  - タスク一覧生成が完了したタイミングで組織ごとに1回分をアトミックに減算。
  - 不足時はタスク生成を不可とし、UI上の選択肢を無効化。
- 月次リセット
  - 毎月の所定タイミングに、残り使用時間/タスク生成回数を各組織の月次上限値へ自動リセット。

## 非機能要件
- リージョンは Japan East。ただし、必要なサービスが対応していない場合、ご相談ください。
- 認証・認可（組織/所有者ベースのアクセス制御）
- 環境分離（開発/本番）
  - 本開発範囲では単一環境で構いません。ただし将来的に環境分離できる設計（設定分離・インフラ分割が可能な構成）を意識してください。
- メンテナンスモード切替(アップデート時などに、ユーザーがアクセスした場合に現在利用不可であることが明記される機能)
  - 必須ではありませんが、実装可能であればお願いします。
- バージョン表示/更新履歴
- ロギング/監視/アラート（一般的なアプリケーションログと、処理失敗時に問い合わせ対応できる最低限の可観測性で十分）
- APIキー・シークレットの安全な保管（Azure Key Vault 等）
- ネットワーク要件：処理はVPC内部で完結（プライベート通信/SASトークン・Private Endpoint 等により最小露出）

## Azureでの実装上の例
- 認証: Azure AD B2C / Entra ID
- ストレージ: Azure Blob Storage（入力/出力の分離とSAS/ユーザー権限制御）
- バックエンド: Azure Functions（HTTPトリガ/Queue/Timerで非同期二段構成）
- リアルタイム更新: Azure Web PubSub / SignalR（GraphQL Subの代替）
- AI: Azure OpenAI（Whisper, GPT）
- 設定/鍵: Azure Key Vault
- 監視: Application Insights / Log Analytics

## 参照資料
- 要件定義: `docs/azure/Azure議事録アプリ新規実装要件定義書.md`
- RFP: `docs/azure/RFP.md`
- 共通仕様: `docs/specs/` （API/スキーマ/フロントUI/UX 等）

---

ご不明点や前提不一致があれば、着手前/実装中いずれのタイミングでもご相談ください。改善提案は歓迎します。
